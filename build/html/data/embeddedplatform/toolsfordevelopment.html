<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tools for development &mdash; BFMC - Competition Documentation  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="canonical" href="https://boschfuturemobility.com/data/embeddedplatform/toolsfordevelopment.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Debugging the code" href="debugging.html" />
    <link rel="prev" title="Embedded platform" href="../embeddedplatform.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> BFMC - Competition Documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../connectiondiagram.html">Connection diagram and components</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../connectiondiagram/components.html">Components list</a></li>
<li class="toctree-l2"><a class="reference internal" href="../connectiondiagram/printedcomponents.html">Printed components - 3D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../connectiondiagram/powerboard.html">Powerboard</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../racetrack.html">Race track</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../racetrack/groundmarkings.html">Ground markings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../racetrack/trafficsigns.html">Traffic signs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../racetrack/otherelements.html">Other elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../racetrack/positioning.html">Positioning on track</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../vehicletoeverything.html">V2X - Vehicle to everything</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../vehicletoeverything/localizationsysandmap.html">Localization system and mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vehicletoeverything/semaphore.html">Semaphore</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vehicletoeverything/livetraffic.html">Live traffic system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vehicletoeverything/vehicletovehicle.html">V2V - Vehicle to vehicle communication</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../embeddedplatform.html">Embedded platform</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Tools for development</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html">Debugging the code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../brain.html">Brain project</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../brain/pythonmultiprocessing.html">Python and multiprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../brain/rosversion.html">ROS setup and packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../brain/roswithsimulator.html">ROS with simulator data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../computer.html">Computer projects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../computer/setup.html">Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../computer/testing.html">Simulated servers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../computer/demo.html">Demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../computer/dashboard.html">Dashboard</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../simulator.html">Simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../useful.html">Useful</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../useful/usageraspberryclassic.html">Usage of rasbery pi - Classical approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="../useful/usageRaspberryFast.html">Usage of rasbery pi - Fast approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="../useful/ROS.html">Robot Operating System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../useful/coding.html">Coding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../useful/hardwareimprovements.html">Hardware improvements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../useful/materials.html">Aditional materials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../periodicstatus.html">Periodic status and examples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">BFMC - Competition Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../embeddedplatform.html">Embedded platform</a></li>
      <li class="breadcrumb-item active">Tools for development</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/ECC-BFMC/Documentation/blob/master/source/data/embeddedplatform/toolsfordevelopment.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tools-for-development">
<h1>Tools for development<a class="headerlink" href="#tools-for-development" title="Permalink to this heading"></a></h1>
<p>The low level control application, which runs on the Nucleo-F401RE, is implemented in C/C++ language
by using <cite>mbed 5</cite> library. The project structure is simple, it contains fife (5) basic folder:
doc, include, libs, src and BUILD. The ‘BUILD’ folder includes the built binary files, which need
to program the micro-controller. The ‘libs’ incorporates external libraries, like <cite>mbed</cite> and <cite>rtos</cite>. The features and
other scripts are realized in the ‘include’ and ‘src’ folder. while the doc includes the html documentation.
We used Visual Studio Code for developing.</p>
<section id="building">
<h2>Building<a class="headerlink" href="#building" title="Permalink to this heading"></a></h2>
<p>After you modified any part of the components you have to rebuild the application before flashing the micro-controller.
For building you will need to install some other software on your pc.</p>
<p><strong>Windows setup</strong></p>
<p>Firstly you need a cross-compiler, you can find it on the
official site of Arm Developer. Here is a <a class="reference external" href="https://developer.arm.com/tools-and-software/open-source-software/developer-tools/gnu-toolchain/gnu-rm/downloads">link</a> .
If you installed the Gnu Embedded Toolchain for Arm, you need to add a new environment variable with ‘GCC_ARM_FOLDER’ name,
which value is the compiler folder. You can see an example on the following picture.</p>
<a class="reference internal image-reference" href="../../_images/env_var_compiler.png"><img alt="../../_images/env_var_compiler.png" class="align-center" src="../../_images/env_var_compiler.png" style="width: 489.75px; height: 123.75px;" /></a>
<p>Other application necessary for easy building is MSYS2 and to add the location of installation folder to the ‘Path’ environment variable.</p>
<a class="reference internal image-reference" href="../../_images/env_var_mingw.png"><img alt="../../_images/env_var_mingw.png" class="align-center" src="../../_images/env_var_mingw.png" style="width: 393.75px; height: 374.25px;" /></a>
<p>If you set correctly the environment variable, then the ‘make’ command is recognized in command prompt and you can build your application.</p>
<p><strong>Linux setup</strong></p>
<p>The GNU Core utilities are already installed on linux, so only the setup for Gnu Embedded Toolchain for Arm is required, which means you will have to download
a linux version from this <a class="reference external" href="https://developer.arm.com/tools-and-software/open-source-software/developer-tools/gnu-toolchain/gnu-rm/downloads">link</a>
and decompress it on your pc. After decompressing, you need to set the ‘GCC_ARM_FOLDER’ environment variable with the location where you decompressed
the cross-compiler. Therefore the ‘make’ utility knows the location of cross-compiler. To add the persistent environment variable you will need to
introduce a code in terminal similar to the following:</p>
<p>“echo “export GCC_ARM_FOLDER=/home/user/Workspace/Crosscompilers/gcc-arm-none-eabi-8-2019-q3-update/bin” &gt;&gt; ~/.bashrc”</p>
<p>The variable is accessible for only your user and you have to restart the terminal for it to be valid.</p>
<p><strong>Building</strong></p>
<p>After the setup you have to change the location in terminal to main project folder and you can run the ‘make’ script, will build
automatically the project in the ‘BUILD’ folder.</p>
<p>If everything went well, then a new binary file
with name ‘Nucleo_mbedrobot.bin’ appeared in the ‘BUILD’ folder. Success compilation terminates with following message:</p>
<p>‘===== bin file ready to flash: BUILD/Nucleo_mbedrobot.bin =====’.</p>
</section>
<section id="flashing">
<h2>Flashing<a class="headerlink" href="#flashing" title="Permalink to this heading"></a></h2>
<p>The nucleo board has to main parts: the programmer/debugger and the micro-controller. The programmer has the mini-usb connector and a
tricolor LED. The micro-controller has the connectors, reset and user button, power and built-in led, etc. The micro-controller can be powered by
external source (USB) or by a power supply (wires), while the debugger can be powered on only by the USB. The jumper JP5 near the reset
button controllers the power source for the micro-controller (E5V - via external or U5V - via usb).</p>
<p>Before you flash, you have to connect the programmer and make sure the micro-controller is powered on. This is indicated by the power LED (LD3).
You can simply copy the binary file (_.bin) on the micro-controller to flash it or you can apply the ‘flash_win.bat’ script, present in the project
directory (it does the same action). If you use the flash_win, check that the programmer mounted partition identification letter is the same one
mentioned in script. If they don’t match, you can update in the script with the right new one (like D:, F:, C:).</p>
</section>
<section id="new-component">
<h2>New component<a class="headerlink" href="#new-component" title="Permalink to this heading"></a></h2>
<p>When you want to implement some new feature, it’s recommended to keep clean the project structure. For this reason, you need to create the header
files in the ‘include’ directory and the source file in the ‘src’ folder. You can do this by applying the ‘newComponent.py’ script, which creates
automatically the include file and the source file. There are some optional parameters: you can check them by using ‘-help’ parameter.</p>
<p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">newComponent.py</span> <span class="pre">--help</span></code></p>
<p>The script creates two includes files: ‘test.hpp’ and ‘test.inl’. in the ‘include’ folder and a source file (‘test.cpp’) in the ‘src’ folder.</p>
<p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">newComponent.py</span> <span class="pre">-c</span> <span class="pre">test</span></code></p>
<p>If you want to compile these new components, then you must add them to the makefile like new objects. You can see on the figure below, where new
object is defined in the 72nd line:</p>
<a class="reference internal image-reference" href="../../_images/makefile_example.png"><img alt="../../_images/makefile_example.png" class="align-center" src="../../_images/makefile_example.png" style="width: 279.0px; height: 45.0px;" /></a>
<p>Now you can compile your application with the new components by building the project (‘make’ command). You have to see the added component
between the listed source files, like on the figure below:</p>
<a class="reference internal image-reference" href="../../_images/compiling_message.png"><img alt="../../_images/compiling_message.png" class="align-center" src="../../_images/compiling_message.png" style="width: 379.5px; height: 53.25px;" /></a>
</section>
<section id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Permalink to this heading"></a></h2>
<p>The script for creating a new component (newComponent.py) and for flashing the micro-controller weren’t projected to linux usage, so we cannot guarantee the
correct working of them.</p>
<p>If the Nucleo board is communicated with the RPI via our given python startup package, you will have to set the baud rate on the nucleo to 256000.
If the Nucleo board is communicated with the RPI via our given c++ startup package, you will have to set the baud rate on the nucleo to 230400.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../embeddedplatform.html" class="btn btn-neutral float-left" title="Embedded platform" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="debugging.html" class="btn btn-neutral float-right" title="Debugging the code" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Bosch Engineering Center Cluj and BFMC organizers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>