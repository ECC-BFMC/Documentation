<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Python and multiprocessing &mdash; BFMC - Competition Documentation  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="canonical" href="https://boschfuturemobility.com/data/brain/pythonmultiprocessing.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="ROS setup and packages" href="rosversion.html" />
    <link rel="prev" title="Brain project" href="../brain.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> BFMC - Competition Documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../connectiondiagram.html">Connection diagram and components</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../connectiondiagram/components.html">Components list</a></li>
<li class="toctree-l2"><a class="reference internal" href="../connectiondiagram/printedcomponents.html">Printed components - 3D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../connectiondiagram/powerboard.html">Powerboard</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../racetrack.html">Race track</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../racetrack/groundmarkings.html">Ground markings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../racetrack/trafficsigns.html">Traffic signs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../racetrack/otherelements.html">Other elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../racetrack/positioning.html">Positioning on track</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../vehicletoeverything.html">V2X - Vehicle to everything</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../vehicletoeverything/localizationsysandmap.html">Localization system and mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vehicletoeverything/semaphore.html">Semaphore</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vehicletoeverything/livetraffic.html">Live traffic system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vehicletoeverything/vehicletovehicle.html">V2V - Vehicle to vehicle communication</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../embeddedplatform.html">Embedded platform</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../embeddedplatform/toolsfordevelopment.html">Tools for development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../embeddedplatform/debugging.html">Debugging the code</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../brain.html">Brain project</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Python and multiprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="rosversion.html">ROS setup and packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="roswithsimulator.html">ROS with simulator data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../computer.html">Computer projects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../computer/setup.html">Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../computer/testing.html">Simulated servers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../computer/demo.html">Demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../computer/dashboard.html">Dashboard</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../simulator.html">Simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../useful.html">Useful</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../useful/usageraspberryclassic.html">Usage of rasbery pi - Classical approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="../useful/usageRaspberryFast.html">Usage of rasbery pi - Fast approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="../useful/ROS.html">Robot Operating System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../useful/coding.html">Coding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../useful/hardwareimprovements.html">Hardware improvements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../useful/materials.html">Aditional materials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../periodicstatus.html">Periodic status and examples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">BFMC - Competition Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../brain.html">Brain project</a></li>
      <li class="breadcrumb-item active">Python and multiprocessing</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/ECC-BFMC/Documentation/blob/master/source/data/brain/pythonmultiprocessing.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="python-and-multiprocessing">
<h1>Python and multiprocessing<a class="headerlink" href="#python-and-multiprocessing" title="Permalink to this heading"></a></h1>
<section id="repo-cloning">
<h2>Repo cloning<a class="headerlink" href="#repo-cloning" title="Permalink to this heading"></a></h2>
<p>Clone the startup repo on your local RPI. We suggest to also create another repository, accessible to all your team members, for the development of the project.
<a class="reference external" href="https://github.com/ECC-BFMC/Brain">https://github.com/ECC-BFMC/Brain</a></p>
</section>
<section id="remote-car-control-and-camera-stream">
<h2>Remote car control and camera stream<a class="headerlink" href="#remote-car-control-and-camera-stream" title="Permalink to this heading"></a></h2>
<p>In this section is presented the architecture of the main startup tools: Camera Streamer and Remote Control. The following figure shows the structure of our application,
where the remote controller and the camera streamer features are activated and connected (remote device and given RPi).</p>
<p>On the RaspberryPi (RcCar) the following processes run: ‘cameraStreamer’ and ‘RemoteControlReceiverProcess’ on ‘Utils’ layer, ‘cameraProcess’ and ‘SerialHandlerProcess’ on the ‘Hardware’ layer.
Each process uses some paralel threads, for simultaneous handling of the tasks: ‘CameraPublisher’, ‘WriteThread’ &amp; ‘ReadThread’, ‘StreamSending’, ‘ReceivingComand’.</p>
<p>On the remote device run the ‘cameraReceiver’ and the ‘RemoteControlTransmitter’ processes on ‘Utils’ layer.
Each processes use some paralel threads, for simultaneous handling of all the tasks: ‘StreamReceiving’, ‘SendCommand’, ‘RcBrain’and ‘KeyboardListener’.</p>
<p>Another tool is already implemented on the car, and that is the ‘CameraSpoofer’ process. It takes as an input a directory of videos and pipes them
to the ‘CameraStreamerProcess’. For it to work <cite>enableStream</cite> and <cite>enableCameraSpoof</cite> flags have to enable in the ‘main.py’, where the <cite>CameraProcess</cite>
will be in replaced by ‘CameraSpoofer’ process. It will work similarly to the <cite>CameraProcess</cite>, only it will stream the saved videos.</p>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this heading"></a></h2>
<p>The application is compatible with other version of Python3. For using the implemented applications you have to install the Python API of Opencv (<cite>cv2</cite>) on the remote
device (PC) and your Raspberry. If you are using Debian based operating system, you can do it easily by running the following code in terminal:</p>
<p><code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">python3-opencv</span></code></p>
<p>The <cite>requirements</cite> files contains the other dependencies, they are different for the Raspberry Pi and your remote device. The script, which runs on Raspberry Pi,
depends on <cite>pySerial</cite>, <cite>picamera</cite>, <cite>cv2</cite> code libraries. The remote debug and development tools relies on <cite>pynput</cite> and <cite>cv2</cite> libraries. You can install these
libraries by applying the following codes:</p>
<p><em>Raspberry Pi</em></p>
<p><code class="docutils literal notranslate"><span class="pre">pip3</span> <span class="pre">install</span> <span class="pre">-r</span> <span class="pre">requirements_rpi.txt</span></code></p>
<p><em>PC</em></p>
<p><code class="docutils literal notranslate"><span class="pre">pip3</span> <span class="pre">install</span> <span class="pre">-r</span> <span class="pre">requirements_remote.txt</span></code></p>
<dl class="simple">
<dt><em>Note:</em></dt><dd><p>The remote tools were tested on Linux and Windows. On Linux they are worked correctly without any error. On Windows the camera receiver works nicely, but the remote
controller transmitter may produce a delay. On Mac Os the remote tools weren’t tested.</p>
</dd>
</dl>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading"></a></h2>
<p>The first step before being able to test the platform and add more functionalities to it is to configure the scripts that one can find in this repository.
To do so, you will have to set of your IP addresses, for your Raspberry and for your PC, and, if necessary, the ports used for communication. This configuration
should occur every time the IP of one of your devices has changed.</p>
<p>The following files should be considered:</p>
<p><em>Raspberry Pi</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">src/utils/camerastreamer/camerastreamer.py</span></code></p>
</div></blockquote>
<p><em>PC</em></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">src/utils/remotecontrol/remotecontroltransmitter.py</span></code></p>
</div></blockquote>
</section>
<section id="how-to-control-your-car">
<h2>How to control your car<a class="headerlink" href="#how-to-control-your-car" title="Permalink to this heading"></a></h2>
<p>In order to control your car, you will have to start your application onto RaspberryPi and enable from <cite>main.py</cite> the Remote Control feature, by setting the <cite>enableRc</cite>
flag to true value. Also, you will have to launch the Remote Control Transmitter on your PC and make sure that the IP of your devices are configured correctly.
After that, run the following:</p>
<p><em>Raspberry Pi</em></p>
<p><code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">main.py</span></code></p>
<p><em>PC</em></p>
<p><code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">-m</span> <span class="pre">bin.remotecontroltransmitter</span></code></p>
</section>
<section id="how-to-stream-your-camera">
<h2>How to stream your camera<a class="headerlink" href="#how-to-stream-your-camera" title="Permalink to this heading"></a></h2>
<p>If you want to stream the camera and view on the remote device, you will have to start the same application onto RaspberryPi and enable from <cite>main.py</cite> the Camera Steamer
feature, by changing the <cite>enableStream</cite> flag to true value. On the remote device you will have to run the Camera Receiver script. The IP address of the remote device must
be introduced in the <cite>CameraStreamer</cite> class. After the configuration, you can run the following code:</p>
<p><em>Raspberry Pi</em></p>
<p><code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">main.py</span></code></p>
<p><em>PC</em></p>
<p><code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">-m</span> <span class="pre">bin.camerareceiver</span></code></p>
</section>
<section id="imu-displayer">
<h2>IMU Displayer<a class="headerlink" href="#imu-displayer" title="Permalink to this heading"></a></h2>
<p>For our case, we will use the RTIMULib tool. Feel free to implement the functionality by yourselves, even by using another library.
Consider this guide: <a class="reference external" href="https://github.com/RPi-Distro/RTIMULib/tree/master/Linux">https://github.com/RPi-Distro/RTIMULib/tree/master/Linux</a>. For our example, follow the <strong>connecting to IMU</strong> side.
The library has already been installed.</p>
<p>We have provided two scripts, ‘imu.py’ under hardware/imu and ‘imuHandler.py under utils/imu, which should serve as a base for further development with the sensor.
The imu.py is written as a thread and the imuHandler.py is used as an example of running the thread.</p>
<p>In order to test the scripts go to the computer/src:</p>
<p><code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">python3.7</span> <span class="pre">utils/IMU/imuHandler.py</span></code></p>
<p>For a more thorough understanding of the board capabilities you should read the official datasheet of the BNO sensor at <a class="reference external" href="https://www.bosch-sensortec.com/products/smart-sensors/bno055.html">https://www.bosch-sensortec.com/products/smart-sensors/bno055.html</a>
and RTIMULib’s documentation on it’s official GitHub repository: <a class="reference external" href="https://github.com/RPi-Distro/RTIMULib">https://github.com/RPi-Distro/RTIMULib</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../brain.html" class="btn btn-neutral float-left" title="Brain project" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="rosversion.html" class="btn btn-neutral float-right" title="ROS setup and packages" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Bosch Engineering Center Cluj and BFMC organizers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>